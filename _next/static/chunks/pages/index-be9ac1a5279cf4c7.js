(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3810:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(6912)}])},6912:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return et}});var r,o=t(1874),u=t(9953),a=t(89),l=t(3598),c=t(1241),s=t(5734),f=t.n(s),p=t(8541),d=t(2048),y=t.n(d);function $(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function m(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function h(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.forEach(function(e){m(n,e,t[e])})}return n}function v(n,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):(function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t})(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n}function b(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var u=[],a=!0,l=!1;try{for(o=o.call(n);!(a=(t=o.next()).done)&&(u.push(t.value),!e||u.length!==e);a=!0);}catch(c){l=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return u}}(n,e)||_(n,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(n){return function(n){if(Array.isArray(n))return $(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||_(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(n,e){if(n){if("string"==typeof n)return $(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return $(n,e)}}var w=function(n,e,t){return Math.min(Math.max(n,e),t)},x=[0,-1,0,1,0],P=function(n){return x.slice(n,n+2)},k={top:0,left:1,bottom:2,right:3},S=function(n){return null!==(r=k[n])&&void 0!==r?r:function(){throw Error("unexpected direction ".concat(n))}()},j=function(n,e,t,r){var o=n.getBoundingClientRect(),u=e.getBoundingClientRect(),a=o.width/2+(r||0),l=o.height/2+(r||0),c=o.x-u.x,s=o.y-u.y,f=b(P(t),2),p=f[0],d=f[1],y=1&t;return{x:c+(y?0:a)+Math.max(p,0)*o.width,y:s+(y?l:0)+Math.max(d,0)*o.height}},O=function(n,e){var t=document.getElementById(n.from),r=document.getElementById(n.to);if(!t||!r||!e)return{cord0:{x:0,y:0},cord1:{x:0,y:0},cord2:{x:0,y:0},cord3:{x:0,y:0},class:n.class};var o=j(t,e,S(n.positions.start.side),n.positions.start.offset),u=j(r,e,S(n.positions.end.side),n.positions.end.offset),a=Math.abs(u.x-o.x)/2,l=Math.abs(u.y-o.y)/2,c=w(a,30,100),s=w(l,30,100),f=b(P(S(n.positions.start.side)),2),p=f[0],d=f[1],y=b(P(S(n.positions.end.side)),2),$=y[0],m=y[1];return{cord0:o,cord1:{x:o.x+p*c,y:o.y+d*s},cord2:{x:u.x+$*c,y:u.y+m*s},cord3:u,class:n.class}},N=function(n){var e=n.settings,t=n.children,r=(0,u.useRef)(null),a=(0,u.useState)({}),l=a[0],c=a[1],s=(0,u.useState)({}),f=s[0],p=s[1],d=(0,u.useCallback)(function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.reduce(function(n,e){return v(h({},n),m({},"".concat(e.from,";").concat(e.to),h({},O(e,r.current))))},{});c(h({},e,t))},[c]);(0,u.useEffect)(function(){d(e),p(e.reduce(function(n,e){var t;return v(h({},n),(m(t={},e.from,g(n[e.from]||[]).concat([e])),m(t,e.to,g(n[e.to]||[]).concat([e])),t))},{}))},[d,e]),(0,u.useEffect)(function(){if(r.current){var n=new MutationObserver(function(n){var e=new Set,t=!0,r=!1,o=void 0;try{for(var u,a=n[Symbol.iterator]();!(t=(u=a.next()).done);t=!0){var c=u.value.target;if(f[c.id])f[c.id].forEach(function(n){return e.add(n)});else{var s=c.innerHTML;if(!s)continue;var p=s.matchAll(/id=['"`](.+?)['"`]/g),y=Array.from(p).map(function(n){return n[1]}),$=!0,m=!1,h=void 0;try{for(var v,b=y[Symbol.iterator]();!($=(v=b.next()).done);$=!0){var g=v.value;f[g]&&f[g].forEach(function(n){return e.add(n)})}}catch(_){m=!0,h=_}finally{try{$||null==b.return||b.return()}finally{if(m)throw h}}}}}catch(w){r=!0,o=w}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}var x=Array.from(e);x.length&&window.requestAnimationFrame(function(){return d(x,l)})});return n.observe(r.current,{attributes:!0,characterData:!0,subtree:!0,childList:!0}),function(){n.disconnect()}}},[f,l,d]);var $=(0,u.useMemo)(function(){return Object.entries(l)},[l]);return(0,o.jsxs)("div",{ref:r,className:y().container,children:[(0,o.jsx)("svg",{className:y().bezierLine,children:$.map(function(n){var e=b(n,2),t=e[0],r=e[1];return(0,o.jsx)("path",{className:r.class,d:"M".concat(r.cord0.x," ").concat(r.cord0.y)+"C".concat(r.cord1.x," ").concat(r.cord1.y)+",".concat(r.cord2.x," ").concat(r.cord2.y)+",".concat(r.cord3.x," ").concat(r.cord3.y)},t)})}),t]})};function E(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.forEach(function(e){E(n,e,t[e])})}return n}var I=function(n,e,t){return Math.min(Math.max(n,e),t)},D=function(n){var e,t=n.dontcramp,r=n.dragstart,a=void 0===r?function(){}:r,l=n.dragend,c=void 0===l?function(){}:l,s=n.children,f=(0,u.useState)({position:"absolute",userSelect:"none"}),p=f[0],d=f[1],y=(0,u.useRef)(c);y.current=c;var $=(0,u.useCallback)(function(n){var e=n.currentTarget,r=e.getBoundingClientRect(),o=e.parentElement.getBoundingClientRect(),u="touches"in n?n.touches[0]:n,l=u.clientX-r.x,c=u.clientY-r.y,s=u,f=function(n,e){var u=Math.round(n-l-o.x),a=Math.round(e-c-o.y),s=t?u:I(u,0,o.width-r.width),f=t?a:I(a,0,o.height-r.height);return{x:s,y:f}},$=function(n){var e="touches"in n?n.touches[0]:n;s=e;var t,r,o=f(e.clientX,e.clientY),u=o.x,a=o.y;d((t=C({},p),r=(r={left:"".concat(u,"px"),top:"".concat(a,"px")},r),Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t})(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}),t))},m=function(n){document.removeEventListener("mousemove",$),document.removeEventListener("touchmove",$),document.removeEventListener("mouseup",m),document.removeEventListener("touchend",m);var e="touches"in n?s:n,t=f(e.clientX,e.clientY),r=t.x,o=t.y;y.current(n.currentTarget,r,o,d)};document.addEventListener("mousemove",$),document.addEventListener("touchmove",$),document.addEventListener("mouseup",m),document.addEventListener("touchend",m);var h,v=f(u.clientX,u.clientY);a(e,v.x,v.y),n.stopPropagation()},[a,y,t,p]),m=u.Children.only(s);return(0,o.jsx)(o.Fragment,{children:(0,u.isValidElement)(m)?(0,u.cloneElement)(m,{onMouseDown:$,onTouchStart:$,style:C({},null===(e=m.props)||void 0===e?void 0:e.style,p)}):m})},L=t(3817);function A(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function F(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function T(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.forEach(function(e){F(n,e,t[e])})}return n}var B={from:null,to:null},M=function(){return T({},B)},R=function(n){var e,t,r,a,l,c,s=n.id,f=n.className,p=n.style,d=n.handlers,y=function(n){if(Array.isArray(n))return n}(e=n.stateTuple)||function(n,e){var t,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var u=[],a=!0,l=!1;try{for(o=o.call(n);!(a=(t=o.next()).done)&&(u.push(t.value),!e||u.length!==e);a=!0);}catch(c){l=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return u}}(e,2)||function(n,e){if(n){if("string"==typeof n)return A(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return A(n,e)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),$=y[0],m=y[1],h=(0,u.useRef)($);h.current=$;var v=(0,u.useMemo)(function(){return{dragstart:null!==(t=d.dragstart)&&void 0!==t?t:function(n,e,t){},dragmove:null!==(r=d.dragmove)&&void 0!==r?r:function(n,e){},dragend:null!==(a=d.dragend)&&void 0!==a?a:function(n){},linkpreview:null!==(l=d.linkpreview)&&void 0!==l?l:function(n,e){},unlinkpreview:null!==(c=d.unlinkpreview)&&void 0!==c?c:function(n,e){}}},[d]),b=(0,u.useRef)(v);b.current=v;var g=(0,u.useCallback)(function(n){var e=T({},$);do{if(!e.from)break;e.to=n.currentTarget.id||null,e.from&&e.to&&e.from!==e.to&&v.linkpreview(e.from,e.to),m(e)}while(!1);n.stopPropagation()},[$,m,v]),_=(0,u.useCallback)(function(n){var e=T({},$);do{if(!e.from)break;e.from&&e.to&&e.from!==e.to&&v.unlinkpreview(e.from,e.to),e.to=null,m(e)}while(!1);n.stopPropagation()},[$,m,v]),w=(0,u.useCallback)(function(n){var e=T({},$),t="touches"in n?n.touches[0]:n;do if("break"===function(){if(e.from=n.currentTarget.id||null,e.to=null,!e.from||(e.from=null!==(r=v.dragstart(e.from,t.clientX,t.clientY))&&void 0!==r?r:e.from,!e.from))return"break";var r,o=function(n){var e="touches"in n?n.touches[0]:n;b.current.dragmove(e.clientX,e.clientY),"touches"in n&&document.elementFromPoint(e.clientX,e.clientY),n.stopPropagation()},u=function(n){var e=T({},h.current);b.current.dragend(e.from&&e.to&&e.from!==e.to?{from:e.from,to:e.to}:void 0),e.from=null,e.to=null,document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",u),document.removeEventListener("touchend",u),m(e),n.stopPropagation()};document.addEventListener("mousemove",o),document.addEventListener("touchmove",o),document.addEventListener("mouseup",u),document.addEventListener("touchend",u)}())break;while(!1);m(e),n.stopPropagation()},[$,m,v]);return(0,o.jsx)("div",{id:s,className:f,style:p,onMouseDown:w,onTouchStart:w,onMouseEnter:g,onMouseLeave:_})},z=t(4869),X=t.n(z);function U(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function q(n,e,t,r,o,u,a){try{var l=n[u](a),c=l.value}catch(s){t(s);return}l.done?e(c):Promise.resolve(c).then(r,o)}function H(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var u=n.apply(e,t);function a(n){q(u,r,o,a,l,"next",n)}function l(n){q(u,r,o,a,l,"throw",n)}a(void 0)})}}var Y,G,Q,W,Z,K,J,V,nn,ne,nt,nr,no=function(n,e){var t,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function l(u){return function(l){return function(u){if(t)throw TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(n,a)}catch(l){u=[6,l],r=0}finally{t=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}},nu={output:{inputs:[{name:"sound",param:null,type:"channels"}],outputs:[],make:(Y=H(function(n){return no(this,function(e){return[2,n.destination]})}),function(n){return Y.apply(this,arguments)})},oscillator:{inputs:[{name:"freq",param:"frequency",type:"param",default:"440",unit:"Hz"},{name:"type",type:"scalar",choice:["sine","square","sawtooth","triangle","custom"]},],outputs:[{name:"sound",param:null,type:"channels"},],make:(G=H(function(n){return no(this,function(e){return[2,new OscillatorNode(n)]})}),function(n){return G.apply(this,arguments)})},buffer:{inputs:[],outputs:[{name:"buffer",param:null,type:"buffer"},],make:(Q=H(function(n,e){return no(this,function(t){switch(t.label){case 0:if(e.abuffer)return[2,e.abuffer];if(!e.bbuffer)return[3,2];return[4,n.decodeAudioData(e.bbuffer.slice(0))];case 1:return[2,t.sent()];case 2:return[2,null]}})}),function(n,e){return Q.apply(this,arguments)})},sampler:{inputs:[{name:"buffer",type:"buffer"},{name:"loop",type:"scalar",default:"false",choice:["false","true"],toScalar:function(n){return"false"!==n}},{name:"loopStart",type:"param",default:"0",unit:"sec",plug:!1},{name:"loopEnd",type:"param",default:"0",unit:"sec",plug:!1},{name:"rate",param:"playbackRate",type:"param",default:"1"},],outputs:[{name:"sound",param:null,type:"channels"}],make:(W=H(function(n){return no(this,function(e){return[2,new AudioBufferSourceNode(n)]})}),function(n){return W.apply(this,arguments)})},gain:{inputs:[{name:"sound",type:"channels"},{name:"gain",type:"param",default:"1"},],outputs:[{name:"sound",param:null,type:"channels"},],make:(Z=H(function(n){return no(this,function(e){return[2,new GainNode(n)]})}),function(n){return Z.apply(this,arguments)})},biquad:{inputs:[{name:"sound",type:"channels"},{name:"freq",param:"frequency",type:"param",default:"8000",unit:"Hz"},{name:"q",param:"Q",type:"param",default:"0"},{name:"gain",type:"param",default:"1"},{name:"type",type:"scalar",choice:["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"]},],outputs:[{name:"sound",param:null,type:"channels"},],make:(K=H(function(n){return no(this,function(e){return[2,new BiquadFilterNode(n)]})}),function(n){return K.apply(this,arguments)})},delay:{inputs:[{name:"sound",type:"channels"},{name:"time",param:"delayTime",type:"param",default:"1",unit:"sec"},],outputs:[{name:"sound",param:null,type:"channels"},],make:(J=H(function(n){return no(this,function(e){return[2,new DelayNode(n)]})}),function(n){return J.apply(this,arguments)})},compressor:{inputs:[{name:"sound",type:"channels"},{name:"threshold",type:"param",default:"-24",unit:"dB"},{name:"knee",type:"param",default:"30",unit:"dB"},{name:"ratio",type:"param",default:"12",unit:"dB"},{name:"attack",type:"param",default:"0.003",unit:"sec"},{name:"release",type:"param",default:"0.25",unit:"sec"},],outputs:[{name:"sound",param:null,type:"channels"},],make:(V=H(function(n){return no(this,function(e){return[2,new DynamicsCompressorNode(n)]})}),function(n){return V.apply(this,arguments)})},panner:{inputs:[{name:"sound",type:"channels"},{name:"pan",type:"param",default:"0",unit:"right"},],outputs:[{name:"sound",param:null,type:"channels"},],make:(nn=H(function(n){return no(this,function(e){return[2,new StereoPannerNode(n)]})}),function(n){return nn.apply(this,arguments)})},constant:{inputs:[{name:"offset",type:"param",default:"1"},],outputs:[{name:"sound",param:null,type:"channels"},],make:(ne=H(function(n){return no(this,function(e){return[2,new ConstantSourceNode(n)]})}),function(n){return ne.apply(this,arguments)})},convolver:{inputs:[{name:"sound",type:"channels"},{name:"buffer",type:"buffer"},{name:"normalize",type:"scalar",default:"true",choice:["false","true"],toScalar:function(n){return"false"!==n}},],outputs:[{name:"sound",param:null,type:"channels"},],make:(nt=H(function(n){return no(this,function(e){return[2,new ConvolverNode(n)]})}),function(n){return nt.apply(this,arguments)})},add:{inputs:[{name:"sound",type:"channels"},{name:"sound",type:"channels"},],outputs:[{name:"sound",param:null,type:"channels"},],make:(nr=H(function(n){return no(this,function(e){return[2,new GainNode(n)]})}),function(n){return nr.apply(this,arguments)})}},na=function(n){return"buffer"===n?"b":"c"},ni=function(n,e,t,r){return"n".concat(n).concat(e).concat(t).concat(na(r))},nl=function(n){var e=/^n([0-9]+)i([0-9]+)([a-z])$/.exec(n);return e?{nodeNo:parseInt(e[1]),pinNo:parseInt(e[2]),type:e[3]}:null},nc=function(n){var e=/^n([0-9]+)o([0-9]+)([a-z])$/.exec(n);return e?{nodeNo:parseInt(e[1]),pinNo:parseInt(e[2]),type:e[3]}:null},ns=function(n){var e,t,r=nu[n];if(!r)throw Error("unknown NodeType ".concat(n));return{type:n,inputs:r.inputs.map(function(n){var r;return{connectFrom:null,value:null!==(t=null!==(e=n.default)&&void 0!==e?e:null===(r=n.choice)||void 0===r?void 0:r[0])&&void 0!==t?t:null}}),loading:!1,bbuffer:null,abuffer:null,lasterror:null,invalid:!1}};function nf(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function np(n,e,t,r,o,u,a){try{var l=n[u](a),c=l.value}catch(s){t(s);return}l.done?e(c):Promise.resolve(c).then(r,o)}function nd(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var u=n.apply(e,t);function a(n){np(u,r,o,a,l,"next",n)}function l(n){np(u,r,o,a,l,"throw",n)}a(void 0)})}}var ny,n$=function(n,e){var t,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function l(u){return function(l){return function(u){if(t)throw TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(n,a)}catch(l){u=[6,l],r=0}finally{t=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}},nm=function(n){var e=n.pin;return(0,o.jsx)("div",{className:X().label,children:e.name})},nh=function(n){var e=n.pin,t=n.value,r=n.onChange;return(0,o.jsx)("div",{className:X().inputbox,children:(0,o.jsxs)("label",{children:[e.name,": ",e.choice?(0,o.jsx)("select",{value:t,onChange:function(n){return r(n.target.value)},children:e.choice.map(function(n){return(0,o.jsx)("option",{label:n,value:n},n)})}):(0,o.jsx)("input",{type:"param"===e.type?"number":"text",value:t,onChange:function(n){return r(n.target.value)}}),e.unit]})})},nv=(ny=nd(function(n,e,t){var r,o,u,a,l;return n$(this,function(c){switch(c.label){case 0:if(!e)return[2];e(n,((r={}).loading=!0,r)),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,t()];case 2:return o=c.sent(),e(n,((u={}).buffer=o,u)),[3,4];case 3:return a=c.sent(),e(n,((l={}).error=a,l)),[3,4];case 4:return[2]}})}),function(n,e,t){return ny.apply(this,arguments)}),nb=function(n){var e=n.nodeNo,t=n.io,r=n.pinNo,u=n.pin,a=n.plugParams;return"scalar"===u.type||!1===u.plug?null:(0,o.jsx)(R,{id:ni(e,t,r,u.type),className:"".concat(X().plug," ").concat("b"===na(u.type)?X().plugb:X().plugc),handlers:a.handlers,stateTuple:a.stateTuple})},ng=function(n){var e,t,r=n.className,a=n.style,l=n.index,c=n.state,s=n.plugParams,f=n.onChange,d=n.onRemove,y=n.onLoadBuffer,$=nu[c.type],m=(0,u.useRef)(null),h=function(n){if(Array.isArray(n))return n}(e=(0,p.L)({accept:[L.FILE,L.URL],collect:function(n){return{isOver:n.isOver()}},drop:function(n,e){if(n.files&&y){var t=n.files[0];nv(l,y,nd(function(){return n$(this,function(n){return[2,t.arrayBuffer()]})}))}n.urls&&(m.current.value=n.urls[0])}},[l,y,m]))||function(n,e){var t,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var u=[],a=!0,l=!1;try{for(o=o.call(n);!(a=(t=o.next()).done)&&(u.push(t.value),!e||u.length!==e);a=!0);}catch(c){l=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return u}}(e,2)||function(n,e){if(n){if("string"==typeof n)return nf(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nf(n,e)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),v=h[0].isOver,b=h[1];return(0,o.jsxs)("div",{ref:"buffer"===c.type?b:void 0,className:"".concat(X().base," ").concat(c.invalid?X().error:""," ").concat(v?X().dropping:""," ").concat(r||""),style:a,children:[(0,o.jsx)("div",{className:X().title,children:c.type}),$.inputs.map(function(n,e){return(0,o.jsxs)("div",{className:"".concat(X().slot," ").concat(X().input),children:[(0,o.jsx)(nb,{nodeNo:l,io:"i",pinNo:e,pin:n,plugParams:s}),"channels"===n.type||"buffer"===n.type?(0,o.jsx)(nm,{pin:n}):(0,o.jsx)(nh,{pin:n,value:c.inputs[e].value||"",onChange:function(n){return f({state:c,nodeNo:l,inNo:e},n)}})]},e)}),"buffer"!==c.type?null:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:{margin:"5px 5px"},children:[(0,o.jsx)("input",{ref:m,style:{width:"8em"},type:"text",placeholder:"URL..."}),(0,o.jsx)("button",{onClick:function(n){return nv(l,y,nd(function(){return n$(this,function(n){switch(n.label){case 0:return[4,fetch(m.current.value)];case 1:return[4,n.sent().arrayBuffer()];case 2:return[2,n.sent()]}})}))},children:"Load"})]}),(0,o.jsx)("div",{style:{margin:"5px 5px"},children:c.abuffer?(0,o.jsxs)(o.Fragment,{children:[c.abuffer.duration.toFixed(2)," sec (",(t=c.bbuffer.byteLength)<1e3?"".concat(t,"B"):t<1e6?"".concat((t/1e3).toFixed(2),"KB"):"".concat((t/1e6).toFixed(2),"MB"),")"]}):"empty"})]}),c.lasterror?(0,o.jsx)("div",{style:{padding:"5px 5px",color:"red"},children:c.lasterror}):null,$.outputs.map(function(n,e){return(0,o.jsxs)("div",{className:"".concat(X().slot," ").concat(X().output),children:[(0,o.jsx)(nm,{pin:n}),(0,o.jsx)(nb,{nodeNo:l,io:"o",pinNo:e,pin:n,plugParams:s})]},e)}),d&&"output"!==c.type&&(0,o.jsx)("div",{className:X().remove,onClick:function(n){return d(l)}})]})},n_=function(n){var e=n.index,t=n.state,r=n.plugParams,u=n.x,a=n.y,l=n.dragstart,c=n.dragend,s=n.onChange,f=n.onRemove,p=n.onLoadBuffer;return(0,o.jsx)(D,{dragstart:l,dragend:c,children:(0,o.jsx)("div",{style:{left:u,top:a},children:(0,o.jsx)(ng,{index:e,state:t,plugParams:r,onChange:s,onRemove:f,onLoadBuffer:p})})})};function nw(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function nx(n){if(Array.isArray(n))return n}function n0(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nP(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function nk(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nS(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.forEach(function(e){n0(n,e,t[e])})}return n}function nj(n,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):(function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t})(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n}function n8(n){return nx(n)||nP(n)||nN(n,i)||nk()}function nO(n){return function(n){if(Array.isArray(n))return nw(n)}(n)||nP(n)||nN(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nN(n,e){if(n){if("string"==typeof n)return nw(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nw(n,e)}}var nE=function(n,e){return nO(n.slice(0,e)).concat(nO(n.slice(e+1)))},n1=function(n,e,t){if(e.length<1)throw Error("empty path: ".concat(JSON.stringify(e)));var r=n8(e),o=r[0],u=r.slice(1);if(u.length<1){if(!Array.isArray(n))return nj(nS({},n),n0({},o,t));if("number"!=typeof o)throw Error("path must be number: ".concat(o));return nO(n.slice(0,o)).concat([t],nO(n.slice(o+1)))}if(!Array.isArray(n))return nj(nS({},n),n0({},o,n1(n[o],u,t)));if("number"!=typeof o)throw Error("path must be number: ".concat(o));return nO(n.slice(0,o)).concat([n1(n[o],u,t)],nO(n.slice(o+1)))},nC=function(n,e,t){if(e.length<1)throw Error("empty path: ".concat(JSON.stringify(e)));var r=n8(e),o=r[0],u=r.slice(1);if(u.length<1){if(!Array.isArray(n))return nj(nS({},n),n0({},o,t(n[o])));if("number"!=typeof o)throw Error("path must be number: ".concat(o));return nO(n.slice(0,o)).concat([t(n[o])],nO(n.slice(o+1)))}if(!Array.isArray(n))return nj(nS({},n),n0({},o,n1(n[o],u,t)));if("number"!=typeof o)throw Error("path must be number: ".concat(o));return nO(n.slice(0,o)).concat([n1(n[o],u,t)],nO(n.slice(o+1)))},n2=function(n,e){return Object.fromEntries(Object.entries(n).filter(function(n){var t,r=(t=n,nx(t)||function(n,e){var t,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var u=[],a=!0,l=!1;try{for(o=o.call(n);!(a=(t=o.next()).done)&&(u.push(t.value),!e||u.length!==e);a=!0);}catch(c){l=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return u}}(t,2)||nN(t,2)||nk()),o=r[0];return r[1],!e.includes(o)}))};function nI(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function nD(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nL(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.forEach(function(e){nD(n,e,t[e])})}return n}function nA(n,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):(function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t})(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n}function n6(n){return function(n){if(Array.isArray(n))return nI(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||nF(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nF(n,e){if(n){if("string"==typeof n)return nI(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nI(n,e)}}var nT=function(n){var e,t=n.nodes,r=n.nodeposs,a=n.onnodeadd,l=n.onnodemove,c=n.onrewire,s=n.onnoderemove,d=n.onchange,y=n.onloadbuffer,$=(0,u.useState)([]),m=$[0],h=$[1],v=n6((0,u.useMemo)(function(){var n;return(n=t).flatMap(function(e,t){return e.inputs.map(function(n,e){return[n,e]}).filter(function(n){return!!n[0].connectFrom}).map(function(r){var o,u=function(n){if(Array.isArray(n))return n}(o=r)||function(n,e){var t,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var u=[],a=!0,l=!1;try{for(o=o.call(n);!(a=(t=o.next()).done)&&(u.push(t.value),!e||u.length!==e);a=!0);}catch(c){l=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return u}}(o,2)||function(n,e){if(n){if("string"==typeof n)return U(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return U(n,e)}}(o,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=u[0],l=u[1];return{from:ni(a.connectFrom.nodeNo,"o",a.connectFrom.pinNo,nu[n[a.connectFrom.nodeNo].type].outputs[a.connectFrom.pinNo].type),to:ni(t,"i",l,nu[e.type].inputs[l].type),positions:{start:{side:"right"},end:{side:"left"}}}})}).map(function(n){return nA(nL({},n),{class:f().blueLine})})},[t])).concat(n6(m)),b=(0,u.useState)({position:"absolute",display:"none"}),g=b[0],_=b[1],w=(0,u.useState)(M()),x="preview",P=(0,u.useCallback)(function(n,e,r){var o=void 0,u=nl(n);if(u){var a=t[u.nodeNo].inputs[u.pinNo].connectFrom;if(!a)return"";c(null,u),o=ni(a.nodeNo,"o",a.pinNo,nu[t[a.nodeNo].type].outputs[a.pinNo].type)}return _(function(n){return nA(nL({},n),{display:"block",left:"".concat(e,"px"),top:"".concat(r,"px")})}),h([{from:o||n,to:x,positions:{start:{side:"right"},end:{side:"left"}},class:"".concat(f().blueLine," ").concat(f().dash)}]),o},[t,c]),k=(0,u.useCallback)(function(n,e){_(function(t){return nA(nL({},t),{left:"".concat(n,"px"),top:"".concat(e,"px")})})},[]),S=(0,u.useCallback)(function(n){if(_(function(n){return nA(nL({},n),{display:"none"})}),h([]),n){var e=nc(n.from);if(e){var t=nl(n.to);t&&e.type===t.type&&c({nodeNo:e.nodeNo,pinNo:e.pinNo},t)}}},[c]),j=(0,u.useCallback)(function(n,e){var t=nc(n);if(t){var r=nl(e);r&&t.type===r.type&&h([{from:n,to:e,positions:{start:{side:"right"},end:{side:"left"}},class:"".concat(f().blueLine)}])}},[]),O=(0,u.useCallback)(function(n,e){nl(e)&&h([{from:n,to:x,positions:{start:{side:"right"},end:{side:"left"}},class:"".concat(f().blueLine," ").concat(f().dash)}])},[]),E=(0,u.useMemo)(function(){return{dragstart:P,dragmove:k,dragend:S,linkpreview:j,unlinkpreview:O}},[P,k,S,j,O]),C=(function(n){if(Array.isArray(n))return n}(e=(0,p.L)({accept:["TmplNode"],drop:function(n,e){a(n.state,e.getSourceClientOffset())}},[a]))||function(n,e){var t,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var u=[],a=!0,l=!1;try{for(o=o.call(n);!(a=(t=o.next()).done)&&(u.push(t.value),!e||u.length!==e);a=!0);}catch(c){l=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return u}}(e,2)||nF(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1];return(0,o.jsx)("div",{ref:C,style:{width:"100%",height:"100%"},children:(0,o.jsxs)(N,{settings:v,children:[t.map(function(n,e){return(0,o.jsx)(n_,{index:e,x:r[e].x,y:r[e].y,state:n,plugParams:{handlers:E,stateTuple:w},dragend:function(n,t,r,o){o(function(n){return n2(n,["left","top"])}),l(e,t,r)},onChange:function(n,e){var t;d(n.nodeNo,n.inNo,e)},onRemove:function(n){s(n)},onLoadBuffer:y},e)}),(0,o.jsx)("div",{id:x,style:g})]})})},n3=t(8491),n4=t(3131),nB=t(379);function n7(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function nM(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var nR=function(n){var e=n.className,t=n.style,r=n.state,a=n.preview;(0,u.useState)(M());var l,c,s,f=function(n){if(Array.isArray(n))return n}(l=(0,n4.c)({type:"TmplNode",item:{state:r},collect:function(n){return{isDragging:!!n.isDragging()}}}))||function(n,e){var t,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var u=[],a=!0,l=!1;try{for(o=o.call(n);!(a=(t=o.next()).done)&&(u.push(t.value),!e||u.length!==e);a=!0);}catch(c){l=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return u}}(l,3)||function(n,e){if(n){if("string"==typeof n)return n7(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return n7(n,e)}}(l,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),p=f[0].isDragging,d=f[1],y=f[2];return(0,u.useEffect)(function(){y((0,nB.r)(),{captureDraggingState:!0})},[y]),(0,o.jsx)("div",{ref:d,style:{opacity:p?.5:1},children:(0,o.jsx)(ng,{className:e,style:(c=function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.forEach(function(e){nM(n,e,t[e])})}return n}({},t||{}),s=(s={boxShadow:a?"0 5px 5px black":void 0},s),Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(s)):(function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t})(Object(s)).forEach(function(n){Object.defineProperty(c,n,Object.getOwnPropertyDescriptor(s,n))}),c),index:999,state:r,plugParams:{handlers:{dragstart:function(){return""}},stateTuple:[{from:null,to:null},function(){}]},onChange:function(){}})})};function nz(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var n5=function(){var n,e,t=(0,n3.f)(function(n){var e,t;return{type:n.getItemType(),item:n.getItem(),offset:(e=n.getInitialSourceClientOffset()||{x:0,y:0},t=n.getDifferenceFromInitialOffset()||{x:0,y:0},{x:e.x+t.x,y:e.y+t.y})}}),r=t.type,u=t.item,a=t.offset;return(0,o.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"},children:(0,o.jsx)("div",{style:{width:"min-content",transform:"translate(".concat(a.x,"px,").concat(a.y,"px)")},children:{TmplNode:(0,o.jsx)(nR,(n=function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.forEach(function(e){nz(n,e,t[e])})}return n}({},u),e=(e={plugHandlers:{dragstart:function(){return""}},plugStateTuple:[{},function(){}],preview:!0},e),Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):(function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t})(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n))}[r]})})},nX=t(897);function nU(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function n9(n,e,t,r,o,u,a){try{var l=n[u](a),c=l.value}catch(s){t(s);return}l.done?e(c):Promise.resolve(c).then(r,o)}function nq(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var u=n.apply(e,t);function a(n){n9(u,r,o,a,l,"next",n)}function l(n){n9(u,r,o,a,l,"throw",n)}a(void 0)})}}function nH(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nY(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.forEach(function(e){nH(n,e,t[e])})}return n}function nG(n,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):(function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t})(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n}function nQ(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var u=[],a=!0,l=!1;try{for(o=o.call(n);!(a=(t=o.next()).done)&&(u.push(t.value),!e||u.length!==e);a=!0);}catch(c){l=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return u}}(n,e)||nZ(n,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nW(n){return function(n){if(Array.isArray(n))return nU(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||nZ(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nZ(n,e){if(n){if("string"==typeof n)return nU(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nU(n,e)}}var nK,nJ=function(n,e){var t,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function l(u){return function(l){return function(u){if(t)throw TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(n,a)}catch(l){u=[6,l],r=0}finally{t=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}},nV=(nK=nq(function(){var n;return nJ(this,function(e){switch(e.label){case 0:return n={},[4,(0,nX.X3)("app",1,(n.upgrade=function(n,e,t,r){n.createObjectStore("save",{})},n))];case 1:return[2,e.sent()]}})}),function(){return nK.apply(this,arguments)}),en={nodes:[{node:{type:"oscillator",inputs:[{connectFrom:null,value:"440"},{connectFrom:null,value:"sine"},],bbuffer:null},nodepos:{x:30,y:230}},{node:{type:"gain",inputs:[{connectFrom:{nodeNo:0,pinNo:0},value:null},{connectFrom:null,value:"0.2"},],bbuffer:null},nodepos:{x:190,y:240}},{node:{type:"output",inputs:[{connectFrom:{nodeNo:1,pinNo:0},value:null},],bbuffer:null},nodepos:{x:330,y:250}},]},ee=function(){var n=(0,u.useState)(800),e=n[0],t=n[1],r=(0,u.useState)(null),s=r[0],p=r[1],d=(0,u.useState)(null),y=d[0],$=d[1],m=(0,u.useState)(!0),h=m[0],v=m[1],b=(0,u.useState)(!1),g=b[0],_=b[1],w=(0,u.useState)(!1),x=w[0],P=w[1],k=(0,u.useState)(""),S=k[0],j=k[1],O=(0,u.useState)(!0),N=O[0],E=O[1];return(0,u.useEffect)(function(){t(window.innerWidth);var n=function(n){return t(window.innerWidth)};return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}},[]),(0,u.useEffect)(function(){nq(function(){var n,e,t,r,o;return nJ(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,nq(function(){var n,e;return nJ(this,function(t){switch(t.label){case 0:return[4,nV()];case 1:return[4,(n=t.sent()).get("save","save")];case 2:if(e=t.sent(),n.close(),e)return[2,e];return[2,en]}})})()];case 1:var a;return t=(e={nodes:(a=n=u.sent()).nodes.map(function(n){return nG(nY({},n.node),{loading:!1,abuffer:null,lasterror:null,invalid:!1})}),nodeposs:a.nodes.map(function(n){return n.nodepos})}).nodes,r=e.nodeposs,p(t),$(r),[3,3];case 2:return o=u.sent(),console.log("save broken; ignored"),[3,3];case 3:return[2]}})})()},[]),(0,u.useEffect)(function(){s&&nq(function(){var n;return nJ(this,function(e){switch(e.label){case 0:return[4,nV()];case 1:var t,r;return[4,(n=e.sent()).put("save",(t=s,r=y,{nodes:t.map(function(n,e){return{node:n2(n,["loading","abuffer","lasterror","invalid"]),nodepos:r[e]}})}),"save")];case 2:return e.sent(),n.close(),[2]}})})()},[s,y]),(0,u.useEffect)(function(){if(s){var n=new AudioContext({sampleRate:44010});return nq(function(){var e;return nJ(this,function(t){switch(t.label){case 0:return[4,Promise.all(s.map(function(e){return nu[e.type].make(n,e)}))];case 1:return e=t.sent(),Array(s.length).fill(0).some(function(n,t){return"buffer"===s[t].type&&e[t]&&!s[t].abuffer})&&p(function(n){return n.map(function(n,t){return nG(nY({},n),{abuffer:"buffer"===n.type?e[t]:null})})}),s.forEach(function(n,t){if(!n.invalid)try{var r=e[t];nu[n.type].inputs.forEach(function(t,o){var u=n.inputs[o],a=u.connectFrom;if(a){if("channels"===t.type)e[a.nodeNo].connect(r);else if("buffer"===t.type)r[t.param||t.name]=e[a.nodeNo];else if("param"===t.type){var l=r[t.param||t.name];l&&e[a.nodeNo].connect(l)}}if("param"===t.type||"scalar"===t.type){var c,s,f=r[t.param||t.name];(c=f,s=AudioParam,null!=s&&"undefined"!=typeof Symbol&&s[Symbol.hasInstance]?!!s[Symbol.hasInstance](c):c instanceof s)?f.value=(t.toScalar||function(n){return parseFloat(n)})(u.value):void 0!==f&&(r[t.param||t.name]=t.toScalar?t.toScalar(u.value):u.value)}})}catch(o){p(function(n){return n1(n,[t,"invalid"],!0)})}}),s.forEach(function(n,t){("oscillator"===n.type||"sampler"===n.type||"constant"===n.type)&&e[t].start()}),[2]}})})(),function(){n.close()}}},[s]),(0,o.jsx)("div",{id:"app",children:(0,o.jsxs)(a.W,{backend:e<800?c.zr:l.PD,children:[(0,o.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"row"},children:[(0,o.jsxs)("div",{className:f().menu,style:{height:"100%",background:"#eee",display:"flex",flexDirection:"column"},children:[(0,o.jsxs)("a",{onClick:function(n){return v(!h)},children:[h?"↓":"↑","Templates",h?"↓":"↑"]}),(0,o.jsx)("a",{onClick:function(n){var e,t;_(!0),j(JSON.stringify((e=s,t=y,{nodes:e.map(function(n,e){return{node:nC(n2(n,["loading","abuffer","lasterror","invalid"]),["bbuffer"],function(n){var e;return null===n?n:(e=n,btoa(String.fromCharCode.apply(null,new Uint8Array(e))))}),nodepos:t[e]}})}),null,2))},children:"Export"}),(0,o.jsx)("a",{onClick:function(n){P(!0),j("")},children:"Import"})]}),(0,o.jsx)("div",{style:{flex:1,height:"100%",position:"relative"},children:s&&y?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nT,{nodes:s,nodeposs:y,onnodeadd:function(n,e){p(nW(s).concat([n])),$(nW(y).concat([e]))},onnodemove:function(n,e,t){$(n1(y,[n],{x:e,y:t}))},onrewire:function(n,e){p(n1(s,[e.nodeNo,"inputs",e.pinNo,"connectFrom"],n))},onchange:function(n,e,t){p(n1(n1(s,[n,"inputs",e,"value"],t),[n,"invalid"],!1))},onnoderemove:function(n){p(nE(s,n).map(function(e){return nG(nY({},e),{inputs:e.inputs.map(function(e){return nG(nY({},e),{connectFrom:e.connectFrom?e.connectFrom.nodeNo===n?null:nG(nY({},e.connectFrom),{nodeNo:e.connectFrom.nodeNo-(n<=e.connectFrom.nodeNo?1:0)}):null})})})})),$(nE(y,n))},onloadbuffer:function(n,e){if("loading"in e){p(n1(n1(s,[n,"loading"],!0),[n,"lasterror"],null));return}if("error"in e){p(n1(n1(s,[n,"loading"],!1),[n,"lasterror"],String(e.error)));return}if("buffer"in e){p(n1(n1(n1(n1(s,[n,"loading"],!1),[n,"lasterror"],null),[n,"bbuffer"],e.buffer),[n,"abuffer"],null));return}throw Error("unknown loadbuffer state ".concat(JSON.stringify(e)))}}),h?(0,o.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",border:"1px solid #ccc",background:"#444c",overflowX:"auto",display:"flex",flexDirection:"row"},children:Object.entries(nu).filter(function(n){var e=nQ(n,2),t=e[0];return e[1],"output"!==t}).map(function(n){var e=nQ(n,2),t=e[0];return e[1],(0,o.jsx)("div",{className:f().tmplmarginer,children:(0,o.jsx)(nR,{state:ns(t)})},t)})}):null,(0,o.jsx)(n5,{})]}):(0,o.jsx)(o.Fragment,{})})]}),g||x?(0,o.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",display:"flex",background:"#444c"},onClick:function(n){n.target===n.currentTarget&&(_(!1),P(!1))},children:(0,o.jsxs)("div",{style:{margin:"auto",width:"60%",height:"60%",padding:"10px",display:"flex",flexDirection:"column",position:"relative",background:"#fff",borderRadius:"10px",boxShadow:"0 10px 10px black"},children:[(0,o.jsx)("h1",{style:{fontSize:"2em",margin:"5px"},children:g?"Export":x?"Import":null}),(0,o.jsx)("textarea",{style:{width:"100%",flex:1,background:N?"white":"#fdd",color:g?"gray":"black"},readOnly:g,value:S,onChange:function(n){if(x){var e=n.target.value;if(E(!0),e)try{var t,r={nodes:(t=JSON.parse(e)).nodes.map(function(n){var e;return nG(nY({},n2(n.node,["nodepos"])),{loading:!1,bbuffer:n.node.bbuffer?(e=n.node.bbuffer,new Uint8Array(Array.prototype.map.call(atob(e),function(n){return n.charCodeAt(0)})).buffer):null,abuffer:null,lasterror:null,invalid:!1})}),nodeposs:t.nodes.map(function(n){return n.nodepos})},o=r.nodes,u=r.nodeposs;p(o),$(u)}catch(a){E(!1)}j(e)}},onClick:function(n){n.currentTarget.select()}}),(0,o.jsx)("div",{className:f().remove,onClick:function(n){_(!1),P(!1)}})]})}):null]})})},et=function(){return(0,o.jsx)(ee,{})}},5734:function(n){n.exports={nodecontainer:"app_nodecontainer__sXZC7",node:"app_node__FXr7f",tmplmarginer:"app_tmplmarginer__lwuL7",blueLine:"app_blueLine__1cKHI",dash:"app_dash__2GzEO",menu:"app_menu__5x9BT",remove:"app_remove__QDEgu"}},2048:function(n){n.exports={container:"bezier_container__ZZB8E",bezierLine:"bezier_bezierLine__OZFSo",default:"bezier_default__5Alz2"}},4869:function(n){n.exports={base:"sndnode_base___MR1u",error:"sndnode_error__fAWBh",dropping:"sndnode_dropping__Te_WL",title:"sndnode_title__AGUeO",slot:"sndnode_slot__tjP4j",label:"sndnode_label__cGXqA",inputbox:"sndnode_inputbox__RUwgH",plug:"sndnode_plug__hz7HB",plugc:"sndnode_plugc__aEQst",plugb:"sndnode_plugb__vyQtZ",input:"sndnode_input__4rIQc",output:"sndnode_output__j07l0",remove:"sndnode_remove__yXJAf"}}},function(n){n.O(0,[319,774,888,179],function(){return n(n.s=3810)}),_N_E=n.O()}]);